<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ùó•ùóúKEV company - Digital Store</title> 
    <link rel="icon" href="https://c.termai.cc/i168/deS.jpg" type="image/jpeg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* CSS yang Diminimalkan dan Dipadatkan (Tidak diubah) */
        :root{--dark-bg:#121212;--dark-surface:#1f1f1f;--dark-highlight:#2a2a2a;--primary-orange:#ff4500;--text-light:#fff;--text-subtle:#aaa;--success-green:#25d366;--danger-red:#dc3545;--ai-color:#00bcd4}body{font-family:Arial,sans-serif;margin:0;padding:0;background-color:var(--dark-bg);color:var(--text-light)}.container{padding:0 10px 100px}.flex-row{display:flex;align-items:center}.page{display:none;padding-bottom:70px}.page-header{font-size:24px;font-weight:700;color:var(--primary-orange);padding:15px 10px;border-bottom:1px solid var(--dark-highlight);margin-bottom:15px}.secondary-content{padding:15px;background-color:var(--dark-surface);border-radius:8px;margin:10px}.secondary-content p{color:var(--text-subtle);font-size:14px}.header{background-color:var(--dark-surface);padding:10px 15px;justify-content:space-between}.logo{display:flex;align-items:center;height:35px;cursor:pointer}.cart-icon{font-size:20px;color:var(--text-light)}.search-bar{padding:10px 15px;background-color:var(--dark-bg)}.search-input-container{background-color:var(--dark-highlight);border-radius:8px;padding:8px 12px;color:var(--text-subtle)}.search-input-container i{margin-right:10px;font-size:16px}.search-input-container input{flex-grow:1;background:transparent;border:none;color:var(--text-light);outline:none;font-size:14px}.slider-section{padding:10px 0}.slider-track{display:flex;overflow-x:hidden;gap:10px;padding:0 10px;scroll-snap-type:x mandatory}.slider-item{min-width:85vw;height:160px;background-color:var(--dark-highlight);border-radius:10px;box-shadow:0 2px 5px rgba(0,0,0,.4);flex-shrink:0;position:relative;scroll-snap-align:start;background-size:cover;background-position:center;display:flex;align-items:flex-end}.banner-content{background-color:rgba(0,0,0,.6);padding:8px 10px;border-bottom-left-radius:10px;border-bottom-right-radius:10px;width:100%;display:flex;justify-content:space-between;align-items:center}.banner-title{font-weight:700;font-size:14px;color:var(--text-light);margin:0}.delete-button-banner{background-color:var(--danger-red);color:#fff;border:none;padding:3px 6px;border-radius:3px;cursor:pointer;font-size:10px;margin-left:10px}.section-title{padding:15px 10px 5px;font-size:18px;font-weight:700;display:flex;align-items:center}.section-title::before{content:'';width:5px;height:18px;background-color:var(--primary-orange);margin-right:8px;border-radius:2px}.categories{display:flex;justify-content:space-around;padding:10px 0;background-color:var(--dark-surface);border-radius:8px;margin:0 10px}.category-item{text-align:center;flex-basis:25%;padding:5px 0;cursor:pointer}.category-item a{text-decoration:none}.icon-box{font-size:20px;background-color:var(--dark-highlight);border-radius:10px;padding:15px;display:inline-block;margin-bottom:5px;color:var(--primary-orange);box-shadow:0 1px 3px rgba(0,0,0,.3)}.category-item span{font-size:12px;display:block;color:var(--text-light)}.category-item.active .icon-box{background-color:var(--primary-orange);color:var(--dark-surface);box-shadow:0 0 10px var(--primary-orange)}.admin-section{background-color:var(--dark-surface);padding:15px;border-radius:8px;margin:10px;display:flex;justify-content:flex-start;align-items:center;gap:10px;flex-wrap:wrap}#admin-actions{display:none;gap:10px;flex-wrap:wrap}.admin-button{padding:8px 15px;background-color:var(--primary-orange);color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:14px}.delete-button{background-color:var(--danger-red);color:#fff;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;font-size:.8em;margin-top:5px}.form-container{background-color:var(--dark-surface);padding:20px;border-radius:8px;margin:10px;display:none}.form-container h3{margin-top:0;color:var(--primary-orange)}.form-container input,.form-container textarea,.form-container select{width:100%;padding:10px;margin-bottom:10px;border:1px solid #333;border-radius:4px;box-sizing:border-box;background-color:var(--dark-highlight);color:var(--text-light);outline:none;font-size:14px}.form-container button{background-color:var(--primary-orange);color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer}#product-list{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;padding:10px;margin:0 -10px}.product-card{background-color:var(--dark-surface);border-radius:4px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.3);cursor:pointer}.product-card img{width:100%;height:150px;object-fit:cover;background-color:var(--dark-highlight)}.card-body{padding:8px;min-height:50px;display:flex;flex-direction:column;justify-content:space-between}.card-body h3{margin:0 0 5px;font-size:14px;line-height:1.2;height:34px;overflow:hidden}.admin-delete-container{display:flex;justify-content:flex-end;margin-top:5px}.delete-button{padding:3px 8px;font-size:10px}.modal{display:none;position:fixed;z-index:1001;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.7)}.modal-content{background-color:var(--dark-surface);margin:10% auto;padding:20px;border-radius:8px;width:90%;max-width:400px;box-shadow:0 4px 10px rgba(0,0,0,.5)}.modal-image{width:100%;height:200px;object-fit:cover;border-radius:6px;margin-bottom:15px;background-color:var(--dark-highlight)}.modal-content h2{color:var(--primary-orange);margin-top:0;font-size:20px}.modal-content p{margin-bottom:10px;font-size:14px;line-height:1.4;color:var(--text-subtle)}.modal-price{font-size:22px;font-weight:700;color:var(--success-green);margin:15px 0;display:block}.modal-buy-button{background-color:var(--success-green);display:block;width:100%;padding:12px;text-align:center;text-decoration:none;color:#fff;border-radius:5px;font-size:16px;font-weight:700;margin-top:15px}.close{color:var(--text-subtle);float:right;font-size:28px;font-weight:700;line-height:1}.close:hover,.close:focus{color:var(--primary-orange);text-decoration:none;cursor:pointer}.copyright-info{text-align:center;padding:15px 10px;font-size:12px;color:var(--text-subtle);background-color:var(--dark-bg);margin-bottom:50px}.copyright-info strong{color:var(--primary-orange)}.footer-nav{position:fixed;bottom:0;left:0;width:100%;background-color:var(--dark-surface);display:flex;justify-content:space-around;align-items:center;padding:5px 0;border-top:1px solid #333;box-shadow:0 -2px 10px rgba(0,0,0,.5);z-index:1000}.footer-nav a{color:var(--text-subtle);text-decoration:none;font-size:10px;text-align:center;padding:5px 0}.footer-nav a i{display:block;font-size:20px;margin-bottom:3px}.footer-nav a.active{color:var(--primary-orange)}.footer-nav #nav-ai.active{color:var(--ai-color)}.history-item{background-color:var(--dark-surface);padding:15px;border-radius:8px;margin-bottom:10px;border-left:5px solid var(--primary-orange)}.history-item h4{margin:0 0 5px;color:var(--text-light);font-size:16px}.history-item p{margin:0 0 5px;font-size:12px;color:var(--text-subtle)}#ai-chat-box{height:400px;overflow-y:auto;background-color:var(--dark-highlight);border-radius:8px;padding:10px;margin-bottom:10px;display:flex;flex-direction:column;gap:10px}.message{max-width:80%;padding:8px 12px;border-radius:15px;font-size:14px}.user-message{background-color:var(--primary-orange);color:#fff;align-self:flex-end;border-bottom-right-radius:3px}.ai-message{background-color:var(--dark-surface);color:var(--ai-color);border:1px solid var(--ai-color);align-self:flex-start;border-bottom-left-radius:3px}#ai-input-container{display:flex;gap:10px}#ai-input{flex-grow:1;padding:10px;border-radius:20px;border:1px solid var(--dark-highlight);background-color:var(--dark-surface);color:var(--text-light);outline:none}#send-ai-btn{background-color:var(--ai-color);color:#fff;border:none;border-radius:50%;width:40px;height:40px;cursor:pointer;font-size:18px;display:flex;justify-content:center;align-items:center}
    </style>
</head>
<body oncontextmenu="return false" oncopy="return false" oncut="return false">

    <div class="flex-row header" id="main-header">
        <div class="logo" onclick="showPage('home-page')">
            <img src="https://c.termai.cc/i168/deS.jpg" alt="Logo RIKEV company" style="height: 35px; width: auto; object-fit: contain;">
            <span style="display: none;">ùó•ùóúKEV company - THE BEST DIGITAL SOLUTION</span>
        </div>
        <div class="cart-icon">
            <i class="fas fa-shopping-cart"></i> <span id="cart-count">0</span>
        </div>
    </div>
    <div class="search-bar" id="main-search-bar">
        <div class="flex-row search-input-container">
            <i class="fas fa-search"></i>
            <input type="text" id="search-input" placeholder="Cari Panel, Script, APK, atau Jasa..." onkeyup="filterProducts()">
        </div>
    </div>

    <div class="admin-section">
        <button class="admin-button" id="login-button" onclick="showAdminLogin()">Admin Login</button>
        <div id="admin-actions">
            <button class="admin-button" onclick="showAddProductForm()">+ Produk</button>
            <button class="admin-button" onclick="showAddBannerForm()">+ Banner</button>
            <button class="admin-button" onclick="showApiKeyForm()">üîß AI Key</button>
            <button class="admin-button" onclick="logoutAdmin()">Logout</button>
        </div>
    </div>

    <div id="add-product-form" class="form-container">
        <h3>Tambah Produk Baru (RIKEV)</h3> 
        <input type="text" id="product-name" placeholder="Paket: Nama Paket/Hosting" required>
        <input type="text" id="product-price" placeholder="Harga: (mis: Rp 50.000)" required>
        <input type="text" id="product-status" placeholder="Status: (mis: Ready/Pre-order)" required>
        <textarea type="text" id="product-description" placeholder="Keterangan: Fitur Utama Produk (Akan Muncul di Pop-up)" rows="3" required></textarea>
        <input type="text" id="product-owner-name" placeholder="Nama Owner:" required>
        <input type="text" id="product-owner-wa" placeholder="Nomor Owner: (mis: 62812345678)" required>
        <input type="url" id="product-image-link" placeholder="Link Gambar Produk:" required>
        <select id="product-category" required>
            <option value="">-- Pilih Kategori Produk --</option>
            <option value="Panel">Panel</option>
            <option value="Script">Script</option>
            <option value="APK">APK</option>
            <option value="Jasa">Jasa</option>
        </select>
        <button onclick="addProduct()">Simpan Produk</button>
    </div>

    <div id="add-banner-form" class="form-container">
        <h3>Tambah Banner Baru (Kadaluarsa 2 Hari)</h3>
        <input type="text" id="banner-title" placeholder="Judul/Pesan Banner" required>
        <input type="url" id="banner-image-link" placeholder="Link Gambar Banner (Disarankan 800x300px)" required>
        <p style="font-size: 12px; color: var(--danger-red);">*Banner akan otomatis hilang dari katalog dalam waktu 48 jam.</p>
        <button onclick="addBanner()">Simpan Banner</button>
    </div>
    
    <div id="api-key-form" class="form-container">
        <h3>Perbarui Kunci API AI</h3>
        <p style="color: var(--ai-color); font-size: 12px;">Simulasi: Kunci ini harus diisi agar Asisten AI berfungsi.</p>
        <input type="text" id="ai-api-key" placeholder="Masukkan Kunci API AI (Contoh: sk-xxxx-yyyy)" required>
        <button onclick="saveApiKey()">Simpan Kunci API</button>
        <p style="font-size: 12px; margin-top: 10px;">Status Kunci Saat Ini: <strong id="api-key-status">Belum Diatur</strong></p>
    </div>


    <div class="page" id="home-page">
        <div class="container">
            <div class="slider-section">
                <div class="slider-track" id="slider-track"></div>
            </div>
            <div class="section-title">KATEGORI PILIHAN</div>
            <div class="categories">
                <div class="category-item" id="cat-panel" onclick="filterProducts('Panel')"><a href="javascript:void(0)"><div class="icon-box"><i class="fas fa-desktop"></i></div></a><span>Panel</span></div>
                <div class="category-item" id="cat-script" onclick="filterProducts('Script')"><a href="javascript:void(0)"><div class="icon-box"><i class="fas fa-code"></i></div></a><span>Script</span></div>
                <div class="category-item" id="cat-apk" onclick="filterProducts('APK')"><a href="javascript:void(0)"><div class="icon-box"><i class="fab fa-android"></i></div></a><span>APK</span></div>
                <div class="category-item" id="cat-jasa" onclick="filterProducts('Jasa')"><a href="javascript:void(0)"><div class="icon-box"><i class="fas fa-tools"></i></div></a><span>Jasa</span></div>
            </div>
            <div class="section-title">SEMUA PRODUK DIGITAL</div>
            <div id="product-list"></div>
        </div>
    </div>

    <div class="page" id="pesanan-page">
        <div class="page-header">Riwayat Pembelian/Pesanan</div>
        <div class="container">
            <p style="text-align: center; color: var(--primary-orange); margin-bottom: 20px;">*Ini adalah simulasi riwayat pembelian (favorit/wishlist) yang disimpan lokal di browser Anda.</p>
            <div id="history-list">
                <p style="text-align: center; color: var(--text-subtle);">Riwayat pembelian kosong.</p>
            </div>
        </div>
    </div>

    <div class="page" id="favorit-page">
        <div class="page-header">Produk Favorit (Wishlist)</div>
        <div class="container">
             <div id="wishlist-list">
                <p style="text-align: center; color: var(--text-subtle);">Belum ada produk yang ditambahkan ke favorit.</p>
            </div>
        </div>
    </div>

    <div class="page" id="ai-page">
        <div class="page-header" style="color: var(--ai-color);"><i class="fas fa-robot"></i> Asisten AI RIKEV</div>
        <div class="container">
            <div id="ai-chat-box">
                <div class="message ai-message">Halo! Saya Asisten AI RIKEV. Tanyakan apa saja tentang toko digital ini (Panel, Script, dll.) atau tanyakan hal umum!</div>
            </div>
            <div id="ai-input-container">
                <input type="text" id="ai-input" placeholder="Ketik pesan Anda di sini..." onkeypress="if(event.keyCode === 13) sendAIChat()">
                <button id="send-ai-btn" onclick="sendAIChat()"><i class="fas fa-paper-plane"></i></button>
            </div>
            <div class="secondary-content" style="margin-top: 15px;">
                <p style="font-size: 12px; color: var(--ai-color);">Status AI: <strong id="ai-key-status-user"></strong></p>
            </div>
        </div>
    </div>

    <div class="copyright-info">
        &copy; 2025. All Rights Reserved. <br>
        Presented by <strong>ùó•ùóúKEV company</strong>. Kolaborasi KEV.STORE X RIVAN STORE.
    </div>

    <div id="product-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <img id="modal-image" class="modal-image" src="" alt="Product Image">
            <h2 id="modal-name">Nama Produk</h2>
            <span id="modal-price" class="modal-price">Rp 0</span>
            <p><strong style="color: var(--primary-orange);">Kategori:</strong> <span id="modal-category"></span></p>
            <p><strong style="color: var(--primary-orange);">Status:</strong> <span id="modal-status"></span></p>
            <p><strong style="color: var(--primary-orange);">Keterangan:</strong></p>
            <p id="modal-description" style="white-space: pre-wrap; color: var(--text-light);"></p>
            <a id="modal-buy-button" href="#" target="_blank" class="modal-buy-button">BELI SEKARANG VIA WHATSAPP</a>
            <button id="add-to-history-btn" class="modal-buy-button" style="background-color: var(--primary-orange); margin-top: 10px;" onclick="addToHistory(currentProductDetail)">Tambahkan ke Riwayat/Favorit</button>
        </div>
    </div>


    <div class="footer-nav">
        <a href="javascript:void(0)" id="nav-home" onclick="showPage('home-page')"><i class="fas fa-home"></i> Beranda</a>
        <a href="javascript:void(0)" id="nav-pesanan" onclick="showPage('pesanan-page')"><i class="fas fa-clipboard-list"></i> Pesanan</a>
        <a href="javascript:void(0)" id="nav-favorit" onclick="showPage('favorit-page')"><i class="fas fa-star"></i> Favorit</a>
        <a href="javascript:void(0)" id="nav-ai" onclick="showPage('ai-page')"><i class="fas fa-robot"></i> AI Chat</a>
    </div>

    <script>
        // === LAPISAN KEAMANAN INTRUSIF SISI KLIEN UNTUK MENCEGAH ANALISIS DAN PENCURIAN ===
        
        // 1. HARD BLOCK PINTASAN KEYBOARD (F12, CTRL+SHIFT+I/J, CTRL+U, CTRL+A/C/V)
        document.addEventListener('keydown', e => {
            const forbiddenKeys = ['F12', 'I', 'J', 'U', 'A', 'C', 'V'];
            const isCtrlShift = e.ctrlKey && e.shiftKey;
            const isCtrl = e.ctrlKey;
            
            // F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U (Inspect/View Source)
            if (e.key === 'F12' || (isCtrlShift && (e.key === 'I' || e.key === 'J')) || (isCtrl && e.key === 'U')) {
                e.preventDefault();
                alert('Akses inspeksi elemen dibatasi!');
            }
            // Ctrl+A, Ctrl+C, Ctrl+V (Salin)
            if (isCtrl && (e.key === 'a' || e.key === 'c' || e.key === 'v')) {
                e.preventDefault();
                alert('Penyalinan konten dilarang!');
            }
        });
        
        // 2. ANTI-DEBUGGING LOOP (Debugger Trap)
        // Jika Developer Tools dibuka, ini akan memaksa browser untuk tetap pada breakpoint.
        (function() {
            function check() {
                // Membandingkan representasi string fungsi. Debugger akan berhenti di sini.
                if (('' + check).match(/debugger/g) || (window.outerHeight - window.innerHeight > 100 || window.outerWidth - window.innerWidth > 100)) {
                     // Ini adalah trik yang memaksa debugger untuk terus berhenti.
                    setInterval(() => {debugger;}, 50); 
                    document.body.innerHTML = '<h1>Akses Developer Tools Terdeteksi. Halaman Dinonaktifkan.</h1>';
                    document.body.style.cssText = 'height: 100vh; display: flex; align-items: center; justify-content: center; background-color: #000; color: #ff4500; margin: 0;';
                }
            }
            check();
            // Lakukan pengecekan secara berkala
            setInterval(check, 1000); 
        })();

        // --- SISTEM ASLI TOKO DIGITAL (Variabel di-obfuscate untuk mengurangi keterbacaan) ---
        
        const $P0 = "üú≤", $T2 = 1728e5; // ADMIN_PASSWORD dan TWO_DAYS_MS
        const $E_P = document.getElementById('product-list'), $E_S = document.getElementById('search-input'), $E_C = document.getElementById('ai-chat-box'), $E_I = document.getElementById('ai-input');
        let $A_L = false, $S_I, $F_R = {category:'all',search:''}, $C_P = null;
        
        function getApiKey(){return localStorage.getItem('ai_api_key_rikev')||''}
        function updateApiKeyStatusDisplay(){
            const key=getApiKey();
            const statusText=key?key.substring(0,10)+'... (Aktif)':'Belum Diatur / Nonaktif';
            const statusColor=key?'var(--ai-color)':'var(--danger-red)';
            const adminStatusElement=document.getElementById('api-key-status');
            if(adminStatusElement){adminStatusElement.textContent=statusText;adminStatusElement.style.color=statusColor}
            const userStatusElement=document.getElementById('ai-key-status-user');
            if(userStatusElement){userStatusElement.textContent=key?'Online dan Siap Melayani':'Offline. Mohon hubungi Admin.';userStatusElement.style.color=statusColor}
        }
        function showApiKeyForm(){
            if(!$A_L){alert('Anda harus login sebagai admin.');return}
            document.getElementById('add-product-form').style.display='none';
            document.getElementById('add-banner-form').style.display='none';
            document.getElementById('api-key-form').style.display='block';
            document.getElementById('ai-api-key').value=getApiKey();
            updateApiKeyStatusDisplay()
        }
        function saveApiKey(){
            const newKey=document.getElementById('ai-api-key').value.trim();
            localStorage.setItem('ai_api_key_rikev',newKey);
            document.getElementById('api-key-form').style.display='none';
            updateApiKeyStatusDisplay();
            alert('Kunci API AI berhasil diperbarui!')
        }
        function appendMessage(sender,text){
            const messageDiv=document.createElement('div');
            messageDiv.className=`message ${sender}-message`;
            messageDiv.textContent=text;
            $E_C.appendChild(messageDiv);
            $E_C.scrollTop=$E_C.scrollHeight
        }
        function sendAIChat(){
            const userText=$E_I.value.trim();
            if(userText==='')return;
            appendMessage('user',userText);
            $E_I.value='';
            const apiKey=getApiKey();
            if(!apiKey){
                setTimeout(()=>{appendMessage('ai','Error: Maaf, Kunci API Asisten AI belum diatur atau nonaktif. Silakan hubungi Admin toko untuk mengaktifkannya.');},1e3);
                return
            }
            const loadingMessage=document.createElement('div');
            loadingMessage.className='message ai-message';
            loadingMessage.innerHTML='<i class="fas fa-spinner fa-spin"></i> Asisten AI sedang mengetik...';
            $E_C.appendChild(loadingMessage);
            $E_C.scrollTop=$E_C.scrollHeight;
            setTimeout(()=>{
                let aiResponse;
                const lowerCaseText=userText.toLowerCase();
                if(lowerCaseText.includes("panel")){aiResponse="Tentu! Kami memiliki berbagai layanan Panel terbaik, seperti Panel SMM dan Panel Game. Silakan cek di bagian Kategori > Panel.";}
                else if(lowerCaseText.includes("script")){aiResponse="Kami menyediakan berbagai Script siap pakai. Gunakan filter Kategori Script untuk melihat daftar lengkapnya.";}
                else if(lowerCaseText.includes("harga")||lowerCaseText.includes("berapa")){aiResponse="Harga produk kami tercantum di detail produk (pop-up) saat Anda mengkliknya. Anda bisa langsung menghubungi owner via WhatsApp untuk penawaran terbaik!";}
                else if(lowerCaseText.includes("admin")||lowerCaseText.includes("owner")){aiResponse="Informasi kontak owner tersedia di setiap detail produk. Jika ada kendala besar, silakan cek informasi di footer.";}
                else if(lowerCaseText.includes("halo")||lowerCaseText.includes("hai")){aiResponse="Halo! Ada yang bisa dibantu? Saya siap menjawab pertanyaan tentang produk-produk digital RIKEV company.";}
                else{aiResponse=`Simulasi AI: Untuk pertanyaan mengenai "${userText}", saya sarankan Anda mencoba mencari produk di menu Beranda atau mengecek Riwayat/Favorit Anda.`;}
                $E_C.removeChild(loadingMessage);
                appendMessage('ai',aiResponse);
            },1500)
        }
        function showPage(pageId){
            document.querySelectorAll('.page').forEach(page=>{page.style.display='none'});
            const activePage=document.getElementById(pageId);
            if(activePage){
                activePage.style.display='block';
                window.scrollTo(0,0);
                const isHomePage=(pageId==='home-page');
                document.getElementById('main-header').style.display=isHomePage?'flex':'none';
                document.getElementById('main-search-bar').style.display=isHomePage?'block':'none';
            }
            document.querySelectorAll('.footer-nav a').forEach(nav=>nav.classList.remove('active'));
            const navId=(pageId==='ai-page')?'nav-ai':`nav-${pageId.split('-')[0]}`;
            document.getElementById(navId).classList.add('active');
            if(pageId==='pesanan-page')renderHistory();
            if(pageId==='favorit-page')renderWishlist();
            if(pageId==='ai-page')updateApiKeyStatusDisplay()
        }
        function getHistory(){const data=localStorage.getItem('kev_rivan_history');return data?JSON.parse(data):[]}
        function saveHistory(history){localStorage.setItem('kev_rivan_history',JSON.stringify(history))}
        function getWishlist(){return getHistory()}
        function updateCartCount(){const count=getHistory().length;document.getElementById('cart-count').textContent=count}
        function addToHistory(product){
            if(!product)return;
            let history=getHistory();
            const exists=history.some(item=>item.id===product.id);
            if(exists){alert(`Produk "${product.name}" sudah ada di Riwayat/Favorit!`);return}
            const historyItem={...product,addedTime:new Date().toLocaleString()};
            history.unshift(historyItem);
            saveHistory(history);
            alert(`Produk "${product.name}" berhasil ditambahkan ke Riwayat dan Favorit!`);
            closeModal();
            updateCartCount()
        }
        function renderHistory(){
            const historyListDiv=document.getElementById('history-list');
            const history=getHistory();
            historyListDiv.innerHTML='';
            if(history.length===0){historyListDiv.innerHTML='<p style="text-align: center; color: var(--text-subtle);">Riwayat pembelian kosong.</p>';return}
            history.forEach(item=>{
                const historyItem=document.createElement('div');
                historyItem.className='history-item';
                historyItem.innerHTML=`
                    <h4>${item.name} (${item.category})</h4>
                    <p>${item.price} - Ditambahkan: ${item.addedTime}</p>
                    <p>Status: <span style="color:${item.status==='Ready'?'var(--success-green)':'var(--danger-red)'}">${item.status}</span></p>
                    <button class="delete-button" onclick="removeFromHistory('${item.id}')">Hapus dari Riwayat</button>
                `;
                historyListDiv.appendChild(historyItem)
            })
        }
        function renderWishlist(){
            const wishlistListDiv=document.getElementById('wishlist-list');
            const wishlist=getWishlist();
            wishlistListDiv.innerHTML='';
            if(wishlist.length===0){wishlistListDiv.innerHTML='<p style="text-align: center; color: var(--text-subtle);">Belum ada produk yang ditambahkan ke favorit.</p>';return}
            wishlist.forEach(item=>{
                const historyItem=document.createElement('div');
                historyItem.className='history-item';
                historyItem.innerHTML=`
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                         <div>
                            <h4>${item.name}</h4>
                            <p>${item.price} - Kategori: ${item.category}</p>
                        </div>
                        <button class="delete-button" onclick="removeFromHistory('${item.id}')">Hapus</button>
                    </div>
                `;
                wishlistListDiv.appendChild(historyItem)
            })
        }
        function removeFromHistory(id){
            if(confirm('Yakin ingin menghapus item ini dari Riwayat/Favorit?')){
                let history=getHistory();
                history=history.filter(item=>item.id!==id);
                saveHistory(history);
                renderHistory();
                renderWishlist();
                updateCartCount();
                alert('Item berhasil dihapus.')
            }
        }
        function showModal(product){
            $C_P=product;
            document.getElementById('modal-image').src=product.imageLink;
            document.getElementById('modal-name').textContent=product.name;
            document.getElementById('modal-price').textContent=product.price;
            document.getElementById('modal-status').textContent=product.status;
            document.getElementById('modal-category').textContent=product.category;
            document.getElementById('modal-description').textContent=product.description;
            document.getElementById('modal-buy-button').href=createWhatsAppLink(product);
            document.getElementById('product-modal').style.display='block';
        }
        function closeModal(){document.getElementById('product-modal').style.display='none'}
        window.onclick=function(event){if(event.target==document.getElementById('product-modal')){closeModal()}}
        function createWhatsAppLink(product){const message=`Halo ${product.ownerName}, saya ingin order produk dari RIKEV company:\n\n*Nama Produk:* ${product.name}\n*Harga:* ${product.price}\n*Status:* ${product.status}\n\nDetail:\n${product.description}\n\nMohon diproses, saya siap transfer. Terima kasih.`;const encodedMessage=encodeURIComponent(message);return`https://wa.me/${product.ownerWa}?text=${encodedMessage}`}
        function getProducts(){const data=localStorage.getItem('kev_rivan_products');return data?JSON.parse(data):[]}
        function saveProducts(products){localStorage.setItem('kev_rivan_products',JSON.stringify(products));filterProducts(null)}
        function filterProducts(category=null){
            if(document.getElementById('home-page').style.display==='none'&&category===null)return;
            let products=getProducts();
            if(category!==null){
                if(category==='all'){$F_R.category='all';$E_S.value='';$F_R.search=''}
                else if($F_R.category===category){$F_R.category='all'}else{$F_R.category=category}
                $E_S.value='';$F_R.search=''
            }else{$F_R.search=$E_S.value.toLowerCase().trim();if($F_R.search){$F_R.category='all'}}
            document.querySelectorAll('.category-item').forEach(item=>{item.classList.remove('active')});
            if($F_R.category!=='all'&&$F_R.category){
                const activeId='cat-'+$F_R.category.toLowerCase();
                const activeElement=document.getElementById(activeId);
                if(activeElement){activeElement.classList.add('active')}
            }
            const filteredProducts=products.filter(product=>{
                const matchesCategory=$F_R.category==='all'||(product.category&&product.category.toLowerCase()===$F_R.category.toLowerCase());
                const matchesSearch=!$F_R.search||product.name.toLowerCase().includes($F_R.search)||(product.description&&product.description.toLowerCase().includes($F_R.search));
                return matchesCategory&&matchesSearch
            });
            renderFilteredProducts(filteredProducts)
        }
        function renderFilteredProducts(products){
            $E_P.innerHTML='';
            if(products.length===0){$E_P.innerHTML='<p style="text-align: center; margin-top: 20px; color: var(--text-subtle);">Produk tidak ditemukan.</p>';return}
            products.forEach(product=>{
                const productCard=document.createElement('div');
                productCard.className='product-card';
                productCard.setAttribute('data-category',product.category||'');
                productCard.onclick=()=>showModal(product);
                productCard.innerHTML=`
                    <img src="${product.imageLink}" alt="${product.name}" onerror="this.onerror=null; this.src='https://via.placeholder.com/400x400/333333/ff4500?text=${product.name.substring(0,10)}...'">
                    <div class="card-body">
                        <h3>${product.name}</h3>
                        ${$A_L?`
                            <div class="admin-delete-container">
                                <button class="delete-button" onclick="event.stopPropagation(); deleteProduct('${product.id}')">Hapus</button>
                            </div>
                        `:''}
                    </div>
                `;
                $E_P.appendChild(productCard)
            })
        }
        function addProduct(){
            if(!$A_L){alert('Anda harus login sebagai admin.');return}
            const name=document.getElementById('product-name').value.trim();
            const price=document.getElementById('product-price').value.trim();
            const status=document.getElementById('product-status').value.trim();
            const description=document.getElementById('product-description').value.trim();
            const ownerName=document.getElementById('product-owner-name').value.trim();
            const imageLink=document.getElementById('product-image-link').value.trim();
            const category=document.getElementById('product-category').value.trim();
            let ownerWa=document.getElementById('product-owner-wa').value.replace(/[^0-9]/g,'');
            if(!name||!price||!status||!description||!ownerName||!imageLink||!ownerWa||!category){alert('Semua kolom harus diisi!');return}
            if(category===""){alert('Mohon pilih Kategori Produk!');return}
            if(ownerWa.startsWith('0')){ownerWa='62'+ownerWa.substring(1)}
            if(!ownerWa.startsWith('62')){alert('Format Nomor Owner WhatsApp harus dimulai dengan 62');return}
            const products=getProducts();
            const newProduct={id:Date.now().toString(),name,price,status,description,ownerName,ownerWa,imageLink,category};
            products.push(newProduct);
            saveProducts(products);
            document.querySelectorAll('#add-product-form input, #add-product-form textarea').forEach(el=>el.value='');
            document.getElementById('product-category').value='';
            document.getElementById('add-product-form').style.display='none';
            alert('Produk berhasil ditambahkan!')
        }
        function deleteProduct(id){
            if(!$A_L){alert('Anda harus login sebagai admin.');return}
            if(confirm('Yakin ingin menghapus produk ini?')){
                let products=getProducts();
                products=products.filter(product=>product.id!==id);
                saveProducts(products);
                alert('Produk berhasil dihapus!')
            }
        }
        function getBanners(){
            const data=localStorage.getItem('kev_rivan_banners');
            let banners=data?JSON.parse(data):[];
            const now=Date.now();
            const activeBanners=banners.filter(banner=>(now-banner.creationTimestamp)<$T2);
            if(activeBanners.length!==banners.length){saveBanners(activeBanners,!1)}
            return activeBanners
        }
        function saveBanners(banners,shouldRender=!0){localStorage.setItem('kev_rivan_banners',JSON.stringify(banners));if(shouldRender){renderBanners()}}
        function addBanner(){
            if(!$A_L){alert('Anda harus login sebagai admin.');return}
            const title=document.getElementById('banner-title').value.trim();
            const imageLink=document.getElementById('banner-image-link').value.trim();
            if(!title||!imageLink){alert('Judul dan link gambar harus diisi!');return}
            const banners=getBanners();
            const newBanner={id:Date.now().toString(),title,imageLink,creationTimestamp:Date.now()};
            banners.push(newBanner);
            saveBanners(banners);
            document.getElementById('banner-title').value='';
            document.getElementById('banner-image-link').value='';
            document.getElementById('add-banner-form').style.display='none';
            alert(`Banner berhasil ditambahkan!`)
        }
        function deleteBanner(id){
            if(!$A_L){alert('Anda harus login sebagai admin.');return}
            if(confirm('Yakin ingin menghapus banner ini?')){
                let banners=getBanners();
                banners=banners.filter(banner=>banner.id!==id);
                saveBanners(banners);
                alert('Banner berhasil dihapus!')
            }
        }
        function renderBanners(){
            const banners=getBanners();
            const sliderTrack=document.getElementById('slider-track');
            sliderTrack.innerHTML='';
            if(banners.length===0){
                sliderTrack.innerHTML=`<div class="slider-item" style="background-color: var(--dark-highlight);">
                    <div class="banner-content"><p class="banner-title">Belum ada Banner Aktif</p></div>
                </div>`;
                clearInterval($S_I);
                return
            }
            banners.forEach(banner=>{
                const item=document.createElement('div');
                item.className='slider-item';
                item.style.backgroundImage=`url(${banner.imageLink})`;
                item.innerHTML=`
                    <div class="banner-content">
                        <p class="banner-title">${banner.title}</p>
                        ${$A_L?`<button class="delete-button-banner" onclick="deleteBanner('${banner.id}')">Hapus</button>`:''}
                    </div>
                `;
                sliderTrack.appendChild(item)
            });
            startAutoSlide()
        }
        function startAutoSlide(){
            clearInterval($S_I);
            const banners=getBanners();
            if(banners.length<=1)return;
            let currentIndex=0;
            const slideDuration=3e3;
            $S_I=setInterval(()=>{
                currentIndex=(currentIndex+1)%banners.length;
                const firstItem=document.querySelector('#slider-track .slider-item');
                if(!firstItem)return;
                const scrollAmount=currentIndex*(firstItem.offsetWidth+10);
                document.getElementById('slider-track').scrollTo({left:scrollAmount,behavior:'smooth'})
            },slideDuration)
        }
        function showAdminLogin(){
            const inputPassword=prompt('Masukkan password admin:');
            if(inputPassword===$P0){
                $A_L=!0;
                document.getElementById('admin-actions').style.display='flex';
                document.getElementById('login-button').style.display='none';
                filterProducts('all');
                renderBanners();
                alert('Login Admin Berhasil!')
            }else if(inputPassword!==null){alert('Password salah!')}
        }
        function logoutAdmin(){
            $A_L=!1;
            document.getElementById('admin-actions').style.display='none';
            document.getElementById('add-product-form').style.display='none';
            document.getElementById('add-banner-form').style.display='none';
            document.getElementById('api-key-form').style.display='none';
            document.getElementById('login-button').style.display='block';
            filterProducts('all');
            renderBanners();
            alert('Logout Admin Berhasil!')
        }
        function showAddProductForm(){
            document.getElementById('add-banner-form').style.display='none';
            document.getElementById('api-key-form').style.display='none';
            document.getElementById('add-product-form').style.display='block';
        }
        function showAddBannerForm(){
            document.getElementById('add-product-form').style.display='none';
            document.getElementById('api-key-form').style.display='none';
            document.getElementById('add-banner-form').style.display='block';
        }

        document.addEventListener('DOMContentLoaded',()=>{
            updateCartCount();
            filterProducts('all');
            renderBanners();
            showPage('home-page');
            updateApiKeyStatusDisplay();
            if(!$A_L){
                document.getElementById('admin-actions').style.display='none';
                document.getElementById('login-button').style.display='block';
            }
        });
    </script>

</body>
</html>
